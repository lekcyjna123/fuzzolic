

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; Fuzzolic  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Internals" href="internals.html" />
    <link rel="prev" title="Installation" href="install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Fuzzolic
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fuzzy-sat-cli">Fuzzy-SAT (cli)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#text-ui">Text UI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#concolic-execution-standalone-mode">Concolic execution (standalone mode)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hybrid-fuzzing-afl-mode">Hybrid fuzzing (AFL mode)</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="debug.html">Debugging</a></li>
</ul>
<p class="caption"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="icse-experiments.html">ICSE Experiments</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Fuzzolic</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/usage.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="fuzzy-sat-cli">
<h2>Fuzzy-SAT (cli)<a class="headerlink" href="#fuzzy-sat-cli" title="Permalink to this headline">¶</a></h2>
<p>The program <code class="docutils literal notranslate"><span class="pre">fuzzy-solver</span></code> can be used to solve SMT queries using the Fuzzy-SAT algorithm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ fuzzy-solver --help

Usage: ./build/bin/fuzzy-solver [OPTIONS]
  -h, --help                print this help and exit
  -q, --query               SMT2 query filename (required)
  -s, --seed                binary seed file (required)
  -o, --out                 output directory

  --dsat                    dump sat queries
  --dproofs                 dump sat proofs
  --notui                   no text UI
</pre></div>
</div>
<p>It takes as mandatory command line arguments an smt2 query file with <code class="docutils literal notranslate"><span class="pre">--query</span></code> and a seed file with <code class="docutils literal notranslate"><span class="pre">--seed</span></code>. Optionally, the user can specify an output folder (<code class="docutils literal notranslate"><span class="pre">--out</span></code>) where it dumps the sat queries (<code class="docutils literal notranslate"><span class="pre">--dsat</span></code>) and the assignments for sat queries (<code class="docutils literal notranslate"><span class="pre">--dproofs</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">fuzzy-solver</span></code> will try to solve every <em>assert</em> contained in the <em>smt2</em> file.
Note that the symbols in the smt2 file MUST be declared as 8-bit bitvectors, and they must be named <code class="docutils literal notranslate"><span class="pre">k!&lt;i&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;i&gt;</span></code> is the index of the i-th byte in the seed that represents the initial assignment for that symbol. This is an example of smt2 query and seed file:</p>
<p><em>query.smt2</em></p>
<div class="highlight-smt2 notranslate"><div class="highlight"><pre><span></span>(declare-const k!0 (_ BitVec 8))
(declare-const k!1 (_ BitVec 8))
(declare-const k!2 (_ BitVec 8))
(declare-const k!3 (_ BitVec 8))

(assert 
    (= 
        #xdeadbeef 
        (bvadd 
            (concat k!0 k!1 k!2 k!3)
            #xabadcafe))
)
</pre></div>
</div>
<p><em>seed.bin</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0000</span>
</pre></div>
</div>
<div class="section" id="text-ui">
<h3>Text UI<a class="headerlink" href="#text-ui" title="Permalink to this headline">¶</a></h3>
<p>By default, <code class="docutils literal notranslate"><span class="pre">fuzzy-solver</span></code> uses a text UI where it prints useful statistics about the solving process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">query</span> <span class="mi">992</span><span class="o">/</span><span class="mi">992</span>
 <span class="n">o</span><span class="o">-------------------------------------------------------------</span><span class="n">o</span>
 <span class="o">|</span> <span class="n">num</span> <span class="nb">eval</span><span class="p">:</span>   <span class="mi">400528</span>        <span class="n">sat</span><span class="p">:</span>        <span class="mi">147</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">[</span><span class="mi">727</span> <span class="n">opt</span><span class="p">]</span>     <span class="o">|</span>
 <span class="o">|</span>                                                             <span class="o">|</span>
 <span class="o">|</span> <span class="n">its</span><span class="p">:</span>        <span class="mi">91</span>            <span class="n">its</span> <span class="n">ext</span><span class="p">:</span>    <span class="mi">14</span>                    <span class="o">|</span>
 <span class="o">|</span> <span class="n">sm</span><span class="p">:</span>         <span class="mi">8</span>             <span class="n">bf</span><span class="p">:</span>         <span class="mi">11</span>                    <span class="o">|</span>
 <span class="o">|</span> <span class="n">rbf</span><span class="p">:</span>        <span class="mi">4</span>             <span class="n">rbf</span> <span class="n">opt</span><span class="p">:</span>    <span class="mi">6</span>                     <span class="o">|</span>
 <span class="o">|</span> <span class="n">gd</span><span class="p">:</span>         <span class="mi">0</span>             <span class="n">havoc</span><span class="p">:</span>      <span class="mi">0</span>                     <span class="o">|</span>
 <span class="o">|</span> <span class="n">bit</span> <span class="n">flips</span><span class="p">:</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>       <span class="n">byte</span> <span class="n">flips</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>            <span class="o">|</span>
 <span class="o">|</span> <span class="n">arithms</span><span class="p">:</span>    <span class="mi">0</span>             <span class="n">ints</span><span class="p">:</span>       <span class="mi">0</span>                     <span class="o">|</span>
 <span class="o">|</span> <span class="n">multigoal</span><span class="p">:</span>  <span class="mi">5</span>             <span class="n">fallbacks</span><span class="p">:</span>  <span class="mi">164</span> <span class="p">(</span><span class="mi">1120</span><span class="p">)</span><span class="n">si</span> <span class="p">(</span><span class="mi">115</span><span class="p">)</span><span class="n">nt</span>  <span class="o">|</span>
 <span class="o">|</span>                                                             <span class="o">|</span>
 <span class="o">|</span> <span class="c1"># confl:          1203    # univ def:          0            |</span>
 <span class="o">|</span> <span class="n">confl</span> <span class="n">cache</span> <span class="n">size</span><span class="p">:</span> <span class="mi">198</span>     <span class="n">ast</span> <span class="n">info</span> <span class="n">cache</span> <span class="n">size</span><span class="p">:</span> <span class="mi">5378</span>         <span class="o">|</span>
 <span class="o">|</span> <span class="n">num</span> <span class="n">timeouts</span><span class="p">:</span>     <span class="mi">0</span>       <span class="n">ast</span> <span class="n">info</span> <span class="n">cache</span> <span class="n">hits</span><span class="p">:</span> <span class="mi">6387</span>         <span class="o">|</span>
 <span class="o">|</span>                                                             <span class="o">|</span>
 <span class="o">|</span> <span class="n">avg</span> <span class="nb">eval</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.293</span> <span class="n">usec</span>                                   <span class="o">|</span>
 <span class="n">o</span><span class="o">-------------------------------------------------------------</span><span class="n">o</span>
</pre></div>
</div>
<p>[…]</p>
</div>
</div>
<div class="section" id="concolic-execution-standalone-mode">
<h2>Concolic execution (standalone mode)<a class="headerlink" href="#concolic-execution-standalone-mode" title="Permalink to this headline">¶</a></h2>
<p>To run fuzzolic in standalone mode, you need to execute the script <code class="docutils literal notranslate"><span class="pre">./fuzzolic/fuzzolic.py</span></code>. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./fuzzolic/fuzzolic.py -o ./workdir -i ./seeds -- ./program [args] @@
</pre></div>
</div>
<p>will run concolic execution on <code class="docutils literal notranslate"><span class="pre">./program</span></code>, passing (optional) arguments <code class="docutils literal notranslate"><span class="pre">args</span></code>, using initial inputs available in the directory <code class="docutils literal notranslate"><span class="pre">seeds</span></code>, generating the results in the directory <code class="docutils literal notranslate"><span class="pre">./workdir</span></code>. Similarly to AFL, since <code class="docutils literal notranslate"><span class="pre">&#64;&#64;</span></code> is specified for the program, then fuzzolic will assume that the program is getting the input from a file stored on the filesystem (fuzzolic will replace <code class="docutils literal notranslate"><span class="pre">&#64;&#64;</span></code> with the correct path at runtime). When <code class="docutils literal notranslate"><span class="pre">&#64;&#64;</span></code> is not used, fuzzolic will assume that the input is obtained by reading from the standard input. The exploration will follow multiple paths, halting when no new interesting inputs can be generated anymore by fuzzolic.</p>
<p>By default, fuzzolic will use the SMT solver Z3. To select Fuzzy-SAT as the solver backend, add the option <code class="docutils literal notranslate"><span class="pre">-f</span></code> (or <code class="docutils literal notranslate"><span class="pre">--fuzzy</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./fuzzolic/fuzzolic.py -f -o ./workdir -i ./seeds -- ./program [args] @@
</pre></div>
</div>
<p>Several other options can be set to enable additional features:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--afl</span> <span class="pre">AFL_WORKDIR</span></code>: this enables the AFL model, see next section;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--timeout</span> <span class="pre">TIMEOUT</span></code>: maximum cumulative solving time (ms) within one path exploration;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--optimistic-solving</span></code>: this enables optimistic solving;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--single-path</span></code>: fuzzolic will perform a single-path exploration (first input from the seed directory)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--keep-run-dirs</span></code>: intermediate run directories (<code class="docutils literal notranslate"><span class="pre">workdir/fuzzolic-XXXXX</span></code>), containing tracer/solver logs and generated testcases (before discarding uninteresting ones), will not be deleted when this option is set;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--address-reasoning</span></code>: fuzzolic will try to generate testcases that cover different memory addresses when detecting a symbolic pointer during the exploration.</p></li>
</ul>
<p>The full list of fuzzolic options can be seen using <code class="docutils literal notranslate"><span class="pre">./fuzzolic/fuzzolic.py</span> <span class="pre">--help</span></code>.</p>
<p>After (and during) an exploration, the workdir will typically contain the following files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{afl-bitmap,</span> <span class="pre">afl-crash-bitmap,</span> <span class="pre">branch_bitmap,</span> <span class="pre">context_bitmap}</span></code>: bitmaps used by fuzzolic to evaluate whether a branch query is interesting;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fuzzolic-XXXXX/</span></code> (kept only when <code class="docutils literal notranslate"><span class="pre">--keep-run-dirs</span></code> is used): e.g., <code class="docutils literal notranslate"><span class="pre">{fuzzolic-00000,</span> <span class="pre">fuzzolic-00001,</span> <span class="pre">...}</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">solver.log</span></code>: log of the solver backend</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tracer.log</span></code>: log of the QEMU tracer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test_case_ZZZ_YYY.dat</span></code>: e.g., <code class="docutils literal notranslate"><span class="pre">test_case_0_0.dat</span></code>, a test case generated by fuzzolic for path id=<code class="docutils literal notranslate"><span class="pre">XXXXXX</span></code> when processing query with id=<code class="docutils literal notranslate"><span class="pre">ZZZ</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">queue/</span></code>:</p>
<ul>
<li><p>when in standalone mode: test cases (from the seed directory or from previous <code class="docutils literal notranslate"><span class="pre">fuzzolic-XXXXX/</span></code> directories) that still need to be processed by fuzzolic during the current exploration</p></li>
<li><p>when in AFL mode: interesting test cases generated by fuzzolic</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">tests/</span></code>:</p>
<ul>
<li><p>when in standalone mode: interesting test cases generated by fuzzolic</p></li>
<li><p>when in AFL mode: not used</p></li>
</ul>
</li>
</ul>
<p>Hence, when looking for interesting test cases generated by fuzzolic, check the directory <code class="docutils literal notranslate"><span class="pre">tests</span></code> when using fuzzolic in standalone mode. On the other hand, check the directory <code class="docutils literal notranslate"><span class="pre">queue</span></code> when using fuzzolic in AFL mode.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="hybrid-fuzzing-afl-mode">
<h2>Hybrid fuzzing (AFL mode)<a class="headerlink" href="#hybrid-fuzzing-afl-mode" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="internals.html" class="btn btn-neutral float-right" title="Internals" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, Luca Borzacchiello, Emilio Coppa, and Camil Demetrescu

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>